<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cálculo de Prejuízo com ICMS</title>
    <!-- Adicionando o Font Awesome via CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            display: flex;
            justify-content: space-around;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap;
        }
        .table-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 45%;
            margin-bottom: 20px;
        }
        .logo {
            display: block;
            margin: 0 auto 20px;
            max-width: 300px;
            width: 100%;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 24px;
        }
        h2 {
            text-align: center;
            color: #333;
            font-size: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            color: #555;
        }
        .editable {
            border: 2px solid #4CAF50;
            padding: 5px;
            width: 100px;
            text-align: right;
            font-size: 14px;
        }
        .result {
            font-weight: bold;
            color: #d32f2f;
        }
        p {
            text-align: center;
            font-style: italic;
            color: #777;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .description {
            text-align: center;
            color: #555;
            margin-bottom: 20px;
            font-size: 14px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .usage-guide {
            text-align: left;
            color: #555;
            margin: 20px auto;
            font-size: 14px;
            max-width: 800px;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .usage-guide h3 {
            margin-top: 0;
            color: #333;
            font-size: 16px;
        }
        .usage-guide ol {
            margin: 0;
            padding-left: 20px;
        }
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        footer p {
            margin: 0;
            color: #333;
        }
        footer a {
            margin: 0 15px;
            text-decoration: none;
            color: #4CAF50;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            transition: color 0.3s;
        }
        footer a:hover {
            text-decoration: underline;
            color: #45a049;
        }
        footer a i {
            margin-right: 5px;
            font-size: 16px;
        }
        /* Media Query para telas menores (ex.: celulares) */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }
            .table-container {
                width: 90%;
            }
            .logo {
                max-width: 200px;
            }
            h1 {
                font-size: 20px;
            }
            h2 {
                font-size: 18px;
            }
            .editable {
                width: 80px;
                font-size: 12px;
            }
            th, td {
                padding: 8px;
                font-size: 12px;
            }
            p, .description, .usage-guide, .usage-guide h3, .usage-guide ol {
                font-size: 12px;
            }
            .usage-guide {
                margin: 20px 10px;
                padding: 10px;
            }
            .usage-guide h3 {
                font-size: 14px;
            }
            footer {
                padding: 15px;
            }
            footer a {
                display: inline-flex;
                margin: 5px 10px;
                font-size: 12px;
            }
            footer a i {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <img src="logo-bms-seguros.png" alt="Logo BMS Seguros" class="logo">
    <h1>Ferramenta de Cálculo de Prejuízo</h1>
    <p>Altere somente os campos: Peso Total, Valor Total, Peso Descarregado e Alíquota ICMS.</p>
    <div class="description">Esta calculadora ajuda a determinar o prejuízo em operações de carga e frete. Com base no peso total, valor total, peso descarregado e alíquota de ICMS, ela calcula automaticamente o valor do imposto, o prejuízo com e sem ICMS para a carga, e o prejuízo do frete, oferecendo uma visão clara dos custos envolvidos.</div>
    <div class="container">
        <div class="table-container">
            <h2>Cálculo de Prejuízo CARGA (com ICMS)</h2>
            <table>
                <tr>
                    <th>Descrição</th>
                    <th>Valor</th>
                </tr>
                <tr>
                    <td>Peso Total (KG)</td>
                    <td><input type="number" id="pesoTotalCarga" class="editable" value="49620" step="0.01" onkeypress="return restrictInput(event)"></td>
                </tr>
                <tr>
                    <td>Valor Total (NF com ICMS)</td>
                    <td><input type="number" id="valorTotal" class="editable" value="118674.5" step="0.01" onkeypress="return restrictInput(event)"></td>
                </tr>
                <tr>
                    <td>Peso Descarregado (KG)</td>
                    <td><input type="number" id="pesoDescarregado" class="editable" value="24740" step="0.01" onkeypress="return restrictInput(event)"></td>
                </tr>
                <tr>
                    <td>Alíquota ICMS (%)</td>
                    <td><input type="number" id="aliquotaICMS" class="editable" value="17" step="0.01" min="0" max="100" onkeypress="return restrictInput(event)"></td>
                </tr>
                <tr>
                    <td>Base de Cálculo (sem ICMS)</td>
                    <td id="baseCalculo">R$ 101.427,35</td>
                </tr>
                <tr>
                    <td>ICMS</td>
                    <td id="icms">R$ 17.242,65</td>
                </tr>
                <tr>
                    <td>Diferença</td>
                    <td id="diferencaCarga">24880</td>
                </tr>
                <tr>
                    <td>Valor Unitário (sem ICMS)</td>
                    <td id="valorUnitarioSemICMS">R$ 2,04</td>
                </tr>
                <tr>
                    <td>Valor Unitário (com ICMS)</td>
                    <td id="valorUnitarioComICMS">R$ 2,39</td>
                </tr>
                <tr>
                    <td class="result">Prejuízo (sem ICMS)</td>
                    <td id="prejuizoCargaSemICMS" class="result">R$ 50.826,24</td>
                </tr>
                <tr>
                    <td class="result">Prejuízo (com ICMS)</td>
                    <td id="prejuizoCargaComICMS" class="result">R$ 59.504,67</td>
                </tr>
            </table>
        </div>

        <div class="table-container">
            <h2>Cálculo de Prejuízo FRETE</h2>
            <table>
                <tr>
                    <th>Descrição</th>
                    <th>Valor</th>
                </tr>
                <tr>
                    <td>Frete Empresa</td>
                    <td id="freteEmpresa">R$ 12.901,20</td>
                </tr>
                <tr>
                    <td>Peso Total (KG)</td>
                    <td><input type="number" id="pesoTotalFrete" class="editable" value="49620" step="0.01" onkeypress="return restrictInput(event)"></td>
                </tr>
                <tr>
                    <td>Frete P/Ton</td>
                    <td id="fretePorTonelada">R$ 260,00</td>
                </tr>
                <tr>
                    <td>Frete a ser cobrado</td>
                    <td id="freteCobrado">R$ 6.432,40</td>
                </tr>
                <tr>
                    <td class="result">Prejuízo</td>
                    <td id="prejuizoFrete" class="result">R$ 6.468,80</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="usage-guide">
        <h3>Como usar a calculadora:</h3>
        <ol>
            <li>Insira o peso total da carga, o valor total da nota fiscal (com ICMS), o peso descarregado e a alíquota de ICMS (em %) nos campos editáveis.</li>
            <li>Os valores de prejuízo para carga (com e sem ICMS) e frete serão calculados automaticamente.</li>
            <li>Ajuste os valores conforme necessário para ver os resultados atualizados em tempo real.</li>
        </ol>
    </div>

    <footer>
        <p>Criada por BMS Seguros</p>
        <a href="https://www.linkedin.com/in/gabriel-baldez-6a7847217/" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn do Programador</a>
        <a href="https://github.com/GabrielBBaldez" target="_blank"><i class="fab fa-github"></i> GitHub do Programador</a>
        <a href="https://www.linkedin.com/company/bms-seguros/?originalSubdomain=br" target="_blank"><i class="fas fa-building"></i> BMS Seguros</a>
    </footer>

    <script>
        // Função para restringir a entrada de caracteres não numéricos
        function restrictInput(event) {
            const charCode = event.charCode;
            // Permite apenas números (48-57) e ponto (46)
            if (charCode !== 46 && (charCode < 48 || charCode > 57)) {
                return false;
            }
            return true;
        }

        // Função para formatar como dinheiro no padrão brasileiro (ex.: 12.901,20)
        function formatarDinheiro(valor) {
            // Primeiro, arredonda para 2 casas decimais
            const valorArredondado = valor.toFixed(2);
            // Separa a parte inteira e decimal
            const partes = valorArredondado.split('.');
            let parteInteira = partes[0];
            const parteDecimal = partes[1];
            // Adiciona pontos como separadores de milhar
            parteInteira = parteInteira.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
            // Junta as partes com vírgula como separador decimal
            return `R$ ${parteInteira},${parteDecimal}`;
        }

        // Função para atualizar os cálculos
        function atualizarCalculos() {
            // Obtendo valores editáveis
            const pesoTotalCarga = parseFloat(document.getElementById('pesoTotalCarga').value) || 0;
            const valorTotal = parseFloat(document.getElementById('valorTotal').value) || 0;
            const pesoDescarregado = parseFloat(document.getElementById('pesoDescarregado').value) || 0;
            const aliquotaICMS = parseFloat(document.getElementById('aliquotaICMS').value) / 100 || 0;
            const pesoTotalFrete = parseFloat(document.getElementById('pesoTotalFrete').value) || 0;
            const fretePorTonelada = parseFloat(document.getElementById('fretePorTonelada').innerText.replace('R$ ', '').replace('.', '').replace(',', '.')) || 0;
            const freteEmpresa = parseFloat(document.getElementById('freteEmpresa').innerText.replace('R$ ', '').replace('.', '').replace(',', '.')) || 0;

            // Cálculo do ICMS (por dentro, alíquota dinâmica)
            const fatorICMS = 1 - aliquotaICMS;
            const baseCalculo = fatorICMS !== 0 ? valorTotal / fatorICMS : valorTotal;
            const icms = baseCalculo * aliquotaICMS;
            const valorSemICMS = valorTotal - icms;

            // Cálculos para Carga
            const diferencaCarga = pesoTotalCarga - pesoDescarregado;
            const valorUnitarioSemICMS = pesoTotalCarga !== 0 ? valorSemICMS / pesoTotalCarga : 0;
            const valorUnitarioComICMS = pesoTotalCarga !== 0 ? valorTotal / pesoTotalCarga : 0;
            const prejuizoCargaSemICMS = diferencaCarga * valorUnitarioSemICMS;
            const prejuizoCargaComICMS = diferencaCarga * valorUnitarioComICMS;

            // Cálculos para Frete (Frete P/Ton é por tonelada, então divide por 1000)
            const freteCobrado = (pesoDescarregado * fretePorTonelada) / 1000;
            const prejuizoFrete = freteEmpresa - freteCobrado;

            // Atualizando os campos na tela
            document.getElementById('baseCalculo').innerText = formatarDinheiro(baseCalculo);
            document.getElementById('icms').innerText = formatarDinheiro(icms);
            document.getElementById('diferencaCarga').innerText = diferencaCarga.toFixed(2);
            document.getElementById('valorUnitarioSemICMS').innerText = formatarDinheiro(valorUnitarioSemICMS);
            document.getElementById('valorUnitarioComICMS').innerText = formatarDinheiro(valorUnitarioComICMS);
            document.getElementById('prejuizoCargaSemICMS').innerText = formatarDinheiro(prejuizoCargaSemICMS);
            document.getElementById('prejuizoCargaComICMS').innerText = formatarDinheiro(prejuizoCargaComICMS);
            document.getElementById('freteEmpresa').innerText = formatarDinheiro(freteEmpresa);
            document.getElementById('fretePorTonelada').innerText = formatarDinheiro(fretePorTonelada);
            document.getElementById('freteCobrado').innerText = formatarDinheiro(freteCobrado);
            document.getElementById('prejuizoFrete').innerText = formatarDinheiro(prejuizoFrete);
        }

        // Adiciona eventos de input aos campos editáveis
        const editables = document.querySelectorAll('.editable');
        editables.forEach(input => {
            input.addEventListener('input', atualizarCalculos);
        });

        // Executa os cálculos iniciais
        atualizarCalculos();
    </script>
</body>
</html>
